     ╭────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
     │ Complete Setup-Promoter Implementation & E2E Testing Plan                                                  │
     │                                                                                                            │
     │ Overview                                                                                                   │
     │                                                                                                            │
     │ Create a complete promoter setup system with a simple setup page following partner setup-loja design, plus │
     │ comprehensive E2E testing with database manipulation.                                                      │
     │                                                                                                            │
     │ Implementation Tasks                                                                                       │
     │                                                                                                            │
     │ 1. Frontend - Setup-Promoter Page                                                                          │
     │                                                                                                            │
     │ - Create /src/app/(promoter)/setup-promoter/page.tsx                                                       │
     │ - Design: Purple/indigo gradient theme, single card layout                                                 │
     │ - Form Fields: Business Name*, Territory, Specialization, Phone                                            │
     │ - Logic: Auto-approval flow, redirect to /promoter on success                                              │
     │                                                                                                            │
     │ 2. Backend API Updates                                                                                     │
     │                                                                                                            │
     │ - Modify /api/src/controllers/promoter.controller.ts                                                       │
     │   - Add approvedAt: new Date() to promoter creation                                                        │
     │   - Add phone field support                                                                                │
     │   - Ensure isActive: true (auto-approval)                                                                  │
     │ - Update /api/src/schemas/promoter.schema.ts                                                               │
     │   - Add phone field (optional)                                                                             │
     │   - Update validation rules                                                                                │
     │                                                                                                            │
     │ 3. Swagger Documentation                                                                                   │
     │                                                                                                            │
     │ - Update /api/src/routes/promoter.routes.ts                                                                │
     │ - Add phone field to existing POST /api/promoter/apply docs                                                │
     │ - Document auto-approval behavior                                                                          │
     │                                                                                                            │
     │ 4. Frontend API Service                                                                                    │
     │                                                                                                            │
     │ - Update /src/lib/api.ts - promoterService.createProfile()                                                 │
     │ - Add phone parameter support                                                                              │
     │ - Ensure proper response handling                                                                          │
     │                                                                                                            │
     │ E2E Testing Plan                                                                                           │
     │                                                                                                            │
     │ 5. Create E2E Test /tests/e2e/promoter-setup.spec.js                                                       │
     │                                                                                                            │
     │ Test Structure:                                                                                            │
     │                                                                                                            │
     │ 1. Setup Phase                                                                                             │
     │   - Create test promoter user in database via API                                                          │
     │   - Handle email verification if required (using Neon MCP to update emailVerified: true)                   │
     │ 2. Test Flow                                                                                               │
     │   - Login as promoter user                                                                                 │
     │   - Navigate to /setup-promoter                                                                            │
     │   - Fill form with test data:                                                                              │
     │       - Business Name: "Test Promoter Business"                                                            │
     │     - Territory: "São Paulo - SP"                                                                          │
     │     - Specialization: "Vintage Fashion"                                                                    │
     │     - Phone: "(11) 99999-9999"                                                                             │
     │   - Submit form                                                                                            │
     │   - Verify redirect to /promoter dashboard                                                                 │
     │   - Verify promoter profile created in database with:                                                      │
     │       - isActive: true                                                                                     │
     │     - approvedAt: <timestamp>                                                                              │
     │     - Correct form data                                                                                    │
     │ 3. Database Verification                                                                                   │
     │   - Use Neon MCP to query promoter table                                                                   │
     │   - Verify all fields are saved correctly                                                                  │
     │   - Verify auto-approval fields set                                                                        │
     │ 4. Error Handling & Retry Logic                                                                            │
     │   - If email verification errors occur:                                                                    │
     │       - Use Neon MCP to directly update user emailVerified: true                                           │
     │     - Retry test steps                                                                                     │
     │   - If other errors occur:                                                                                 │
     │       - Retry test up to 3 times                                                                           │
     │     - Clean database between retries                                                                       │
     │ 5. Cleanup                                                                                                 │
     │   - Delete test promoter and user records                                                                  │
     │   - Reset any modified data                                                                                │
     │                                                                                                            │
     │ Test Tools:                                                                                                │
     │                                                                                                            │
     │ - Playwright MCP: Browser automation, form filling, navigation                                             │
     │ - Neon MCP: Direct database queries and updates                                                            │
     │ - Retry Logic: Built-in retry mechanism for flaky tests                                                    │
     │ - Database Cleanup: Proper test isolation                                                                  │
     │                                                                                                            │
     │ 6. Test Data                                                                                               │
     │                                                                                                            │
     │ const testPromoterData = {                                                                                 │
     │   email: `test-promoter-${Date.now()}@example.com`,                                                        │
     │   password: 'TestPass123!',                                                                                │
     │   name: 'Test Promoter User',                                                                              │
     │   role: 'PROMOTER',                                                                                        │
     │   businessName: 'Test Promoter Business',                                                                  │
     │   territory: 'São Paulo - SP',                                                                             │
     │   specialization: 'Vintage Fashion',                                                                       │
     │   phone: '(11) 99999-9999'                                                                                 │
     │ };                                                                                                         │
     │                                                                                                            │
     │ Key Implementation Features                                                                                │
     │                                                                                                            │
     │ Auto-Approval Logic                                                                                        │
     │                                                                                                            │
     │ - Set isActive: true immediately                                                                           │
     │ - Add approvedAt: new Date() timestamp                                                                     │
     │ - No manual approval required                                                                              │
     │                                                                                                            │
     │ Error Recovery                                                                                             │
     │                                                                                                            │
     │ - Email verification bypass via direct database update                                                     │
     │ - Retry mechanism for transient failures                                                                   │
     │ - Proper cleanup after each test run                                                                       │
     │                                                                                                            │
     │ Database Integration                                                                                       │
     │                                                                                                            │
     │ - Use Neon MCP for direct database operations                                                              │
     │ - Verify data integrity after form submission                                                              │
     │ - Clean test data to avoid pollution                                                                       │
     │                                                                                                            │
     │ This plan ensures a complete end-to-end flow from user creation through promoter setup completion, with    │
     │ robust error handling and database verification.                                                           │
     ╰────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

